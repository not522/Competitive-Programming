box: ubuntu
command-timeout: 60
build:
  steps:
    - script:
        name: install
        code: |
          apt-get update
          apt-get install software-properties-common -y
          add-apt-repository ppa:ubuntu-toolchain-r/test -y
          apt-get update
          apt-get install make gcc-6 g++-6 wget -y
          update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-6 100
          update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-6 100
          wget -q https://sourceforge.net/projects/boost/files/boost/1.63.0/boost_1_63_0.tar.gz
          tar zxf boost_1_63_0.tar.gz
          cd boost_1_63_0
          ./bootstrap.sh --with-libraries=test
          ./b2 install -d0 -j `grep -c ^processor /proc/cpuinfo 2>/dev/null`
          cd .. && rm -r boost_1_63_0 boost_1_63_0.tar.gz
    - script:
        name: build
        code: |
          make -j `grep -c ^processor /proc/cpuinfo 2>/dev/null`
    - script:
        name: test
        code: |
          make test -j `grep -c ^processor /proc/cpuinfo 2>/dev/null`
